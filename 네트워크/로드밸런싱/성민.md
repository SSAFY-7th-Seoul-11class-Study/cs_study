```
1. 로드 밸런싱에 대해 말해보세요.
2. 많은 트래픽이 발생한 경우 서버에서 대처하는 방법에 대해 말해주세요. =>서버확장
3. 로드 밸런싱 알고리즘에 종류에 대해 말해주세요.
4. L4 로드 밸런싱과 L7 로드 밸런싱에 대해 설명하고, 차이를 말해보세요.
5. 로드 밸런싱의 기본 기능에 대해 말해주세요.
6. ICMP 에 대해 설명해주세요.
7. L4 로드 밸런싱의 장단점을 말해주세요.
8. L7 로드 밸런싱의 장단점을 말해주세요.
9. 오토 스케일링에 대해 말해주세요.
```

## 로드 밸런싱
로드 밸런싱은 주로 서버 구축 및 활용 시에 고려하는데, 서버에 가해지는 부하를 적절하게 분산시켜주는 장치 또는 기술을 말한다.
처음 구축했던 서버가 수용할 수 있는 범위보다 더 큰 트래픽으로 기존 서버를 사용할 수 없게 되는 경우가 있는데 이 때 서버 트래픽을 분산시키기 위해 사용한다.

## 서버 확장
1) Scale-Up
  : 서버 자체의 성능을 향상시키는 것으로, 서버 CPU, RAM 등을 교체해서 서버의 성능을 향상
2) Scale-Out
  : 기존 서버와 동일하거나 낮은 서버를 여러 대 증설해서 운영.
  
=> 보통 Scale-Out 방식을 사용하는데, 서버 성능 향상보다 여러 대 서버를 증설하는 것이 비용적 측면에서 효과적이기 때문

## 오토 스케일링
서버 확장은 서버의 스케일을 조절해서 트래픽을 분산시키는 방법인데, 이 때 서버 스케일링은 전략이 필요하다. 어떤 방식을 사용하고, 얼마나 할 것인지에 대한
전략이 중요한데, 트래픽을 모니터링 하며 트래픽을 예측하여 적절하게 스케일링 해주는 방식이다.

: 사용자가 미리 지정한 오토 스케일링 정책에 따라 트래픽이 발생했을 때 미리 지정된 만큼의 자원이 늘어나게 설정하는 기술.

## 로드 밸런싱 관련 알고리즘
라운드 로빈(Round Robin Method)
- 서버로 들어온 요청을 순서대로 돌아가며 배정하는 방식
- 클라이언트의 요청을 순서대로 분배하기 때문에, 서버들이 동일한 스펙을 갖고 있고, 서버와의 연결(세션)이 오래 지속되지 않는 경우에 적합

가중 라운드로빈 방식(Weighted Round Robin Method)
- 각각의 서버마다 가중치(Weight)를 매기고 가중치가 높은 서버에 클라이언트 요청을 우선적으로 배분
- 주로 서버의 트래픽 처리 능력이 상이한 경우 사용되는 로드밸런식 방식.
- ex) 서버 A의 가중치: 5 / 서버 B의 가중치: 2
 => A 서버에 5개의 Request, B 서버의 2개의 Request 할당
 
 IP 해시 방식(IP Hash Method)
 - 클라이언트의 IP 주소를 특정 서버로 매핑하여 요청을 처리하는 방식
 - 사용자의 IP를 해싱하여 부하를 분산하기 때문에 사용자가 항상 동일한 서버로 연결되는 것을 보장
 - 경로가 보장되며, 접속자 수가 많을수록 분산 및 효율이 뛰어남
 - 여기서 해싱이란 임의의 길이를 지닌 데이터를 고정된 길이의 데이터로 매핑하는 것, 또는 그러한 함수를 의미한다.
 
 최소 연결 방식(Least Connection Method)
- Request가 들어온 시점에 가장 적은 연결(세션) 상태를 보이는 서버에 우선적으로 트래픽을 할당
- 자주 세션이 길어지거나, 서버에 분배된 트래픽들이 일정하지 않은 경우에 적합

최소 응답시간 방식(Least Response Time Method)
- 서버의 현재 연결 상태와 응답시간을 모두 고려하여, 가장 짧은 응답 시간을 보내는 서버로 트래픽을 할당하는 방식
- 각 서버들의 가용한 리소스와 성능, 처리중인 데이터 양 등이 상이할 경우 적합.

대역폭 방식(Bandwidth Method)
- 서버들과의 대역폭을 고려하여 서버에 트래픽을 할당

## 로드 밸런싱 기본 기능
1. Health Check(상태확인)
- 서버들에 대한 주기적인 Health Check를 통해 서버들의 장애 여부를 판단하여, 정상 동작 중인 서버로만 트래픽을 보낸다.
- L3 체크: ICMP를 이용하여 서버의 IP 주소가 통신 가능한 상태인지를 확인
- L4 체크: TCP는 3 Way-Handshaking을 기반으로 통신하는데 이러한 TCP의 특성을 바탕으로 각 포트 상태를 체크
- L7 체크 : 어플리케이션 계층에서 체크를 수행. 실제 웹 페이지에 통신을 시도해서 이상 유무를 파악

p.s ICMP : Internet Control Message Protocol. 패킷 전송에 실패했을 때 에러가 났음을 알림과 동시에, 해결 가능한 힌트를 제공하는 메시징 프로토콜
          TCP/IP의 IP 계층에서 

2. Tunneling(터널링)
- 데이터 스트림을 인터넷 상에서 가상의 파이프를 통해 전달시키는 기술, 패킷 내에 터널링할 대상을 캡슐화하여 목적지까지 전송한다.
- 연결된 상호 간에만 캡슐화된 패킷을 구별해 캡슐화를 해제하게 한다.

3. NAT (Network Address Traslation)
- 내부 네트워크에서 사용하는 사설 IP 주소와 로드밸런서 외부의 공인 IP 주소간의 변환 역할 
- 로드밸런싱 관점에서는 여러 개의 호스트가 하나의 공인 IP 주소를 통해 접속하는 것이 주 목적
- SNAT(Source Network Address Translation) : 내부에서 외부로 트래픽이 나가는 경우
  내부 사설 IP 주소 -> 외부 공이 IP 주소로 변환
- DNAT(Destionation Network Address Translation) : 외부에서 내부로 트래픽이 들어오는 경우
  외부 공인 IP 주소 -> 내부 사설 IP 주소로 변환
  
4. DSL(Destination Network Address Translation)
- 서버에서 클라이언트로 트래픽이 되돌아가는 경우, 목적지를 클라이언트로 설정한 다음, 네트워크 장비나 로드밸런서를 거치지 않고 바로 클라이언트를 찾아가는 방식
- 이 기능을 통해 로드밸런서의 부하를 줄여줄 수 있음

## L4로드 밸런싱
: 4 계층 - 네트워크 계층이나 3계층- 전송계층의 정보를 바탕으로 로드를 분산. 즉, IP 주소, 포트번호, MAC 주소, 전송 프로토콜 등에 따라 트래픽을 분산하는 것이 가능

장점
1. 패킷의 내용을 확인하지 않고 로드를 분산하므로 속도가 빠르고 효율이 높다.
2. 데이터의 내용을 복호화할 필요가 없기에 안전.
3. L7 로드밸런서보다 가격이 저렴.

단점
1. 패킷의 내용을 살펴볼 수 없으므로, 섬세한 라우팅 불가
2. 사용자의 IP가 수시로 바뀌는 경우라면, 연속적인 서비스를 제공하기 어려움

## L7 로드 밸런서
: 7계층 - 어플리케이션 계층에서 로드를 분산하기 때문에, HTTP 헤더, 쿠키 등과 같은 사용자 요청을 기준으로 특정 서버에 트래픽을 분산하는 것이 가능.

장점
1. 상위 계층에서 로드를 분산하기 때문에 훨씬 더 섬세한 라우팅 가능.
2. 캐싱 기능을 제공.
3. 비정상적인 트래픽을 사전에 필터링할 수 있어 서비스 안정성 높음.

단점
1. L4 로드밸런서에 비해 비쌈
2. 패킷의 내용을 복호화해야 해서 더 높은 비용을 지불해야 함.
3. 클라이어트가 로드밸런서와 인증서를 공유해야 하기 때문에, 공격자가 로드밸런서를 통해 클라이언트의 데이터에 접근할 수 있는 보안상의 위험성이 존재.
