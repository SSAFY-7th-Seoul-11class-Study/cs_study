```
SQL Injection, SQL vs NoSQL 예상문제

1. SQL 특징 및 장단점
2. NoSQL 특징 및 장단점
3. SQL이 사용되는 경우
4. NoSQl이 사용되는 경우
5. SQL과 NoSQL의 차이점을 2가지 이상 말하기
6. NoSQL의 데이터 모델 유형 4가지
7. SQL Injection 이란
8. 공격종류 중 하나를 설명하고 방어 방법을 말해보세요.
9. prepared statement를 사용하는 이유는 무엇인가요
10. 규모가 큰 데이터 분석에 주로 사용되는 모델
```

<br>

# SQL Injection

조작된 SQL문을 주입하고 실행되게 하여 데이터베이스가 비정상적인 동작을 하도록 조작하는 행위

<br>

## 공격 종류

<br>

### 인증 우회

로그인 폼에 아이디와 비밀번호를 입력할 시 데이터베이스를 조회하는데 이 때 SQL를 아래와 같이 작성되었다고 하자

> SELECT user FROM user_table WHERE id = '입력한 값' AND password = '입력한 값';

만약 비밀번호에 입력된 값이 `' OR '1'='1` 라고 한다면 아래와 같은 SQL문이 완성된다

> SELECT user FROM user_table WHERE id = '@@@' AND password = '' OR '1'='1';

따라서 고의적으로 입력된 `' OR '1'='1` 때문에 로그인이 성공하게 된다.

<br>

### 데이터 노출

시스템에서 발생하는 에러 메시지를 이용해 공격하는 방법이다. 이를 통해서 데이터베이스의 구조를 유추할 수 있어서 해킹에 활용된다.

- URL 쿼리 스트링 : url 주소에 미리 협의된 데이터를 파라미터를 통해 넘기는 것

<br>

## 방어 방법

1. prepared statement
   미리 작성된 쿼리문이 컴파일 된 후 입력값을 넣기 때문에 쿼리문의 형태가 바뀌지 않는다.
2. Error Message 노출 금지
   에러를 노출하게 되면 테이블명, 컬럼명, 쿼리문이 노출될 수 있다.
3. 입력값 검증
   특수문자에 대한 검증 로직을 추가한다.

---

<br>

# SQL vs NoSQL

<br>

## SQL(관계형 데이터베이스)

고정된 행과 열로 구성된 테이블에 데이터를 저장하는 방식이다. 테이블의 구조와 데이터 타입 등을 사전에 정의하고 테이블에 정의된 내용에 알맞은 형태의 데이터만 삽입될 수 있다.

<br>

## NoSQL(비관계형 데이터베이스)

관계형 데이터베이스를 제외한 나머지를 뜻한다.
NoSQL는 테이블 방식으로 저장하지 않으며 데이터 모델에 따라 유형이 다양하다.
유연성, 확장성, 고성능, 가용성 특징을 가지고 있다.

### NoSQL 데이터 모델 유형

1. Key-Value 타입 : 속성을 key-value의 쌍으로 나타내는 데이터를 배열의 형태로 저장한다.
2. 문서형(Document) 데이터베이스 : 데이터를 테이블이 아닌 JSON과 유사한 형식의 문서처럼 저장하는 방식을 의미한다. 각각의 문서에는 하나의 속성에 대한 데이터를 가지고 있고, 컬렉션이라고 하는 그룹으로 묶어서 관리한다.
3. Wide-Column Store 데이터베이스 : 열(Column)에 대한 데이터를 집중적으로 관리하는 방식이다. 각 열에는 key-value 형식으로 데이터가 저장되고, 컬럼 패밀리라고 하는 열의 집합체 단위로 데이터를 처리한다. 하나의 행에 많은 열을 포함할 수 있어서 유연성이 높고, 필요한 열을 유연하게 선택할 수 있다는 점에서 규모가 큰 데이터 분석에 주로 사용된다.
4. 그래프 데이터베이스 : 그래프와 비슷한 형식으로 데이터 간의 관계를 구성하는 데이터베이스이다. 노드에 속성별로 데이터를 저장한다.

<br>

## SQL 과 NoSQL의 차이점

> 데이터 저장

관계형데이터베이스는 sql을 이용해서 데이터를 테이블에 저장하지만 NoSQL은 key-value, document, wide-column, graph 등의 방식으로 데이터를 저장한다.

> 스키마

SQL은 고정된 형식의 스키마가 필요하다. 추후에 변경이 가능하지만 데이터베이스 전체를 수정하거나 오프라인으로 전환해야 된다는 단점이 있다.
NoSQL은 관계형 데이터베이스보다 동적으로 스키마를 관리할 수 있다.

> 쿼리

SQL은 테이블의 형식과 테이블의 관계에 맞춰 데이터를 요청해야하기 때문에, SQL과 같이 구조화된 쿼리 언어를 사용한다.
NoSQL은 데이터 그룹 자체를 조회하는 것에 초점을 두기 때문에 구조화 되지 않은 쿼리 언어인 UnQL로 데이터 요청이 가능하다.

> 확장성

SQL은 수직적으로 확장이 용이하다. 수직적으로 확장하게 되면 많은 메모리와 CPU 사용 등 하드웨어적인 성능을 많이 요구하기 때문에 비용이 많이 든다.
NoSQL은 수평적으로 확장이 용이하다. SQL의 확장에 비해 상대적으로 비용이 저렴하다.

<br>

## SQL을 사용하는 케이스

1. ACID 성질을 준수해야 하는 경우
2. 소프트웨어에 사용되는 데이터가 구조적이고 일관적인 경우

<br>

## NoSQL을 사용하는 케이스

1. 데이터의 구조가 거의 또는 전혀 없는 대용량의 데이터를 저장하는 경우
2. 클라우드 컴퓨팅 및 저장공간을 최대한 활용하는 경우
3. 빠르게 서비스를 구축하는 과정에서 데이터 구조를 자주 업데이트 하는 경우

<br>

## SQL의 장단점

> 장점

- 명확한 데이터 구조를 보장
- 최소한의 데이터 중복을 가짐

> 단점

- 시스템이 커질 경우 복잡한 쿼리가 생성
- 수직적 확장을 통해 비용이 많이 발생
- 스키마가 변경 될 경우 번거롭거나 어렵다.

<br>

## NoSQL의 장단점

> 장점

- 자유로운 데이터 구조를 가짐
- 언제든지 데이터 구조를 변경할 수 있다.
- 수평적 확장 뿐만 아니라 수직적 확장까지 가능하다.

> 단점

- 데이터의 중복이 발생할 수 있다.
- 명확한 데이터 구조를 보장하지 않는다.
